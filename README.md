Examples that showcase the usage of PheSA for shape-based docking (negative receptor image) and PheSA screening (flexible and rigid)

The examples can be run by using gradle:

```
./gradlew run
```

The concepts are explained briefly 

Dependencies: PheSA is part of the OpenChemLib  https://github.com/Actelion/openchemlib

## Ligand-based PheSA for molecular alignments and virtual screening

PheSA is implemented as a descriptor in the OpenChemLib and requires first a descriptor generation step using a DescriptorHandler. 
There are two DescriptorHandlers for two different purposes: A) generating a PheSA descriptor from a single, bioactive 3D query conformation
and B) generating a descriptor for a candidate molecule, where first a conformer ensemble is generated by the OpenChemLib. 

For case A, the ```DescriptorHandlerShapeOneConf``` has to be used, whereas ```StereoMolecule nativeLigandPose```requires 3D coordinates to be present. 

```
DescriptorHandlerShapeOneConf dhsSC = new DescriptorHandlerShapeOneConf();
PheSAMolecule queryShape = dhs.createDescriptor(nativeLigandPose);
```

whereas for case B, ```DescriptorHandlerShape``` is used and ```StereoMolecule candidateMol```does not require the presence of 3D Coordinate.

```
DescriptorHandlerShape dhs = new DescriptorHandlerShape();
PheSAMolecule candidateShape = dhs.createDescriptor(candidateMol);
```

The descriptor generation step from ```DescriptorHandlerShape``` by default creates a maximum of 200 conformers. This can be adjusted via the constructor: 

```DescriptorHandlerShape(int maxConfs,double ppWeight)``` where the number of conformers and the pharmacophore weight for the similarity calculation can be adjusted. 


## Negative Binding Site Images

To create shape and pharmacophore representation of the receptor binding site, we rely on the ```NegativeReceptorImageCreator```class: 

```
TransformationSequence transform = new TransformationSequence();
ShapeVolume bsVolume = NegativeReceptorImageCreator.create(nativeLigandPose, receptor,transform);
ShapeDocking shapeDocking = new ShapeDocking(bsVolume,transform);
```

nativeLigandPose and receptor are of type ```StereoMolecule``` and rely on the presence of 3D coordinates. The TransformationSequence can be used to later transform the coordinates
of the docked ligand for visual inspection with respect to the protein structure. This step is necessary since the created ```ShapeVolume```is centered at the origin of the coordinate
system. 
A candidate molecule (no 3D coordinates required) can then aligned to the receptor image: 

```
shapeDocking.dock(toDock)
```

Which return a List of aligned StereoMolecules sorted by decreasing score. 

### Starting an own Virtual Screening Campaign

Since the most expensive step in the PheSA workflow is to create the conformers of the screening library, it can save computational resources to precalculate them
and store them into a file. The PheSA DescriptorHandler contains methods to encode and decode instances of ```PheSAMolecule```. Which is a full representation of shape and
pharmacophore of a conformational ensemble (if ```DescriptorHandlerShape```was used as opposed to ```DescriptorHandlerShapeOneConf```).

```
DescriptorHandlerShape dhs = new DescriptorHandlerShape();
PheSAMolecule candidateShape = dhs.createDescriptor(candidateMol);
String encodedShape = dhs.encode(candidateShape);
candidateShape = dhs.decode(encodedShape);
```
